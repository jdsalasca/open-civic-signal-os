openapi: 3.0.3
info:
  title: Open Civic Signal OS API
  version: 0.1.0
paths:
  /api/health:
    get:
      summary: Health check
      responses:
        '200':
          description: API up
          content:
            text/plain:
              schema:
                type: string
  /api/signals/prioritized:
    get:
      summary: Get prioritized civic backlog
      responses:
        '200':
          description: Prioritized list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PrioritizedSignal'
  /api/signals/top-10:
    get:
      summary: Get top 10 unresolved civic problems
      responses:
        '200':
          description: List of top signals
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PrioritizedSignal'
  /api/notifications/recent:
    get:
      summary: Get recent outgoing notification relays
      responses:
        '200':
          description: List of notifications
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Notification'
components:
  schemas:
    Notification:
      type: object
      properties:
        id:
          type: string
        channel:
          type: string
          enum: [WHATSAPP, TELEGRAM, EMAIL]
        message:
          type: string
        sentAt:
          type: string
          format: date-time
        recipientGroup:
          type: string
    ScoreBreakdown:
      type: object
      required:
        - urgency
        - impact
        - affectedPeople
        - communityVotes
      properties:
        urgency:
          type: number
        impact:
          type: number
        affectedPeople:
          type: number
        communityVotes:
          type: number
    PrioritizedSignal:
      type: object
      required:
        - id
        - title
        - category
        - scoreBreakdown
        - priorityScore
        - status
      properties:
        id:
          type: string
        title:
          type: string
        category:
          type: string
        scoreBreakdown:
          $ref: '#/components/schemas/ScoreBreakdown'
        priorityScore:
          type: number
        status:
          type: string
          enum: [NEW, IN_PROGRESS, RESOLVED]
